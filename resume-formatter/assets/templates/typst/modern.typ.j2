// Modern Resume Template - Clean, professional design with Inter font
// Colors: Blue accents (#0066cc), gray text for subtitles

#set page(
  paper: "us-letter",
  margin: (top: 0.4in, bottom: 0.3in, left: 0.5in, right: 0.5in),
)

#set text(font: "Inter", size: 10pt)
#set par(justify: false, leading: 0.6em)

// Colors
#let headerblue = rgb("#0066cc")
#let dateblue = rgb("#0066cc")
#let subtextgray = rgb("#787878")
#let linegray = rgb("#c8c8c8")

// Section header with blue text and thin gray line
#let section(title) = {
  v(0.5em)
  text(size: 14pt, weight: "bold", fill: headerblue)[#title]
  v(-0.6em)
  line(length: 100%, stroke: 0.4pt + linegray)
  v(0.2em)
}

// Experience entry
#let experience-entry(title, dates, company) = {
  grid(
    columns: (1fr, auto),
    text(weight: "bold")[#title],
    text(fill: dateblue)[#dates],
  )
  text(fill: subtextgray)[#company]
  v(0.2em)
}

// Education entry
#let education-entry(degree, institution, year, minor: none) = {
  grid(
    columns: (1fr, auto),
    [
      #text(weight: "bold")[#degree] #sym.dash.en #text(fill: subtextgray)[#institution]
      #if minor != none [ #text(size: 9pt)[(#minor)]]
    ],
    text(fill: dateblue)[#year],
  )
  v(0.3em)
}

// Skill category
#let skill-category(category, skills) = {
  text(size: 9pt, fill: headerblue, weight: "bold")[#category:]
  text(size: 9pt)[ #skills]
  v(0.1em)
}

// ============================================================================
// HEADER
// ============================================================================

#align(center)[
  #text(size: 24pt, weight: "bold")[{{ contact.name | typst_escape }}]
  #v(0.2em)
  {% if contact.title %}
  #text(size: 12pt, fill: subtextgray)[{{ contact.title | typst_escape }}]
  #v(0.2em)
  {% endif %}
  #text(size: 10pt)[
    {% if contact.location %}{{ contact.location | typst_escape }} |{% endif %}
    {% if contact.phone %} {{ contact.phone | typst_escape }} |{% endif %}
    {% if contact.email %} #link("mailto:{{ contact.email }}")[{{ contact.email | typst_escape }}]{% endif %}
    {% if contact.linkedin %} | #link("{{ contact.linkedin }}")[LinkedIn]{% endif %}
    {% if contact.github %} | #link("{{ contact.github }}")[GitHub]{% endif %}
  ]
]

// ============================================================================
// PROFESSIONAL SUMMARY
// ============================================================================

{% if summary %}
#section("Professional Summary")
{{ summary | typst_escape }}
{% endif %}

// ============================================================================
// EXPERIENCE
// ============================================================================

{% if experience %}
#section("Experience")
{% for job in experience %}
{% for position in job.positions %}
#experience-entry(
  [{{ position.title | typst_escape }}],
  [{{ position.dates | typst_escape }}],
  [{{ job.company | typst_escape }}],
)
{% if position.achievements %}
#list(
  marker: [•],
  indent: 1em,
  body-indent: 0.5em,
  spacing: 0.4em,
  {% for achievement in position.achievements %}
  [{{ achievement | typst_escape }}],
  {% endfor %}
)
{% endif %}
#v(0.3em)
{% endfor %}
{% endfor %}
{% endif %}

// ============================================================================
// SKILLS
// ============================================================================

{% if skills %}
#section("Skills")
#columns(2, gutter: 1em)[
  {% for category, skill_list in skills.items() %}
  {% if skill_list is iterable and skill_list is not string %}
  #skill-category([{{ category | typst_escape }}], [{{ skill_list | join(', ') | typst_escape }}])
  {% else %}
  #skill-category([{{ category | typst_escape }}], [{{ skill_list | typst_escape }}])
  {% endif %}
  {% endfor %}
]
{% endif %}

// ============================================================================
// EDUCATION
// ============================================================================

{% if education %}
#section("Education")
{% for edu in education %}
#education-entry(
  [{{ edu.degree | typst_escape }}],
  [{{ edu.institution | typst_escape }}],
  [{{ edu.graduation_year }}],
  {% if edu.minor %}minor: [{{ edu.minor | typst_escape }}],{% endif %}
)
{% endfor %}
{% endif %}

// ============================================================================
// CERTIFICATIONS
// ============================================================================

{% if certifications %}
#section("Certifications")
{% for cert in certifications %}
#grid(
  columns: (1fr, auto),
  text(weight: "bold")[{{ cert.name | typst_escape }}],
  text(fill: dateblue)[{{ cert.date | typst_escape }}],
)
#text(fill: subtextgray)[{{ cert.issuer | typst_escape }}]{% if cert.credential_id %} -- {{ cert.credential_id | typst_escape }}{% endif %}
#v(0.5em)
{% endfor %}
{% endif %}

// ============================================================================
// PROJECTS
// ============================================================================

{% if projects %}
#section("Projects")
{% for project in projects %}
#experience-entry(
  [{{ project.name | typst_escape }}],
  [{{ project.dates | typst_escape }}],
  [{% if project.technologies %}{{ project.technologies | join(', ') | typst_escape }}{% endif %}],
)
{% if project.description or project.achievements %}
#list(
  marker: [•],
  indent: 1em,
  body-indent: 0.5em,
  spacing: 0.4em,
  {% if project.description %}
  [{{ project.description | typst_escape }}],
  {% endif %}
  {% if project.achievements %}
  {% for achievement in project.achievements %}
  [{{ achievement | typst_escape }}],
  {% endfor %}
  {% endif %}
)
{% endif %}
#v(0.3em)
{% endfor %}
{% endif %}

// ============================================================================
// ATTRIBUTION (optional footer)
// ============================================================================

{% if attribution %}
#v(1fr)
#align(center)[
  #text(size: 8pt, fill: subtextgray)[
    {{ attribution.text | typst_escape }}
    {% if attribution.url %} #link("{{ attribution.url }}")[{{ attribution.link_text | typst_escape }}]{% endif %}
  ]
]
{% endif %}
